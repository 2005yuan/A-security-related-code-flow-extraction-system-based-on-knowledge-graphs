
# 基于知识图谱的安全相关代码流提取系统

<img width="921" alt="image" src="https://github.com/DM-1C0N/-/assets/121347600/9f947aba-7ef7-4e0b-b075-b687257e32d0">


## 项目研究目的
在利用大语言模型进行漏洞检测任务时，软件源码可以提供更丰富的语义信息、消除歧义，帮助模型更好地捕捉源码的上下文相关性，使得模型能够根据前文来做出更准确的预测或生成。但当前大语言模型都存在窗口限制，GPT4模型可以使用32K输入词元的上下文长度，大多数开源大语言模型的上下文长度为2K词元，直接修改模型架构增加上下文窗口大小需要大量的计算资源。
本项目的目的在于将与任务最相关的部分源码即安全相关代码流作为输入，引入知识图谱进行安全相关代码流的提取，建立从易受攻击的目标开始的函数调用链，然后从调用链生成危险流。通过该项目可以有效减少上下文长度，并保留连贯的语义信息，不仅可以解决大语言模型在进行漏洞检测任务时存在的窗口大小限制问题，同时可以优化在一次性提供与潜在漏洞相关的所有代码片段或直接指导漏洞分析时结果不尽如人意的问题，利用LLM在代码理解方面的能力来自动化和简化污点分析的手动组件，最终也有发现新的未知漏洞的可能，可以有效提高大语言模型进行漏洞检测任务的正确率。

##  项目研究内容
该项目将基于当前主流的大语言模型，以安全相关代码流为输入，建立模型并引入知识图谱，以提高漏洞检测模型的可靠性和准确性。具体来说，我们将完成以下三个核心任务：
 1. 源码的依赖解析
对源码进行依赖解析，为后续的源码图谱自动化构建和安全相关代码流提取提供基础。在依赖解析的过程中，本项目将根据模块和包之间的引用关系、函数调用和变量赋值等信息来构建源码依赖关系图，同时帮助我们深入理解源码结构和代码间的联系。                                                                                                                                         
 2. 源码图谱的自动化构建
通过源码图谱自动化构建算法，将源码中的依赖关系映射到图谱上，以便为后续的安全相关代码流提取提供便利。通过源码图谱自动化构建，本项目将建立一个完整的源码结构，同时保留源码中的语义信息，并根据源码结构、逻辑等内容，为漏洞检测模型提供一种可视化的交互方式。
 4. 安全相关代码流的提取
本项目将根据漏洞类型和特征等信息，从源码中提取与安全相关的代码流，同时为模型提供针对性的输入，以此避免大项目代码量大无法直接通过大语言模型进行安全漏洞检查的痛点，提高模型的预测准确性和鲁棒性，同时节约计算资源，实现对代码漏洞的精准定位、准确查杀。

## 研究路线及解决的主要问题

1. 项目准备与数据收集  
(1)收集大型项目或代码库的源码，确保多样性和代表性。  
(2)整理漏洞知识图谱，包括漏洞类型、特征、影响等信息。  
(3)确定用于本项目的大语言模型，并准备相应的训练数据和测试数据。

2. 源码依赖解析  
(1)对收集到的源码进行预处理，如去除注释、格式化代码等。  
(2)利用语法分析器和语义分析器，识别源码中的模块、包、函数、变量等元素。  
(3)构建源码依赖关系图，记录模块和包之间的引用关系、函数调用、变量赋值等信息。  

3. 源码图谱自动化构建  
(1)根据依赖关系图，设计源码图谱的构建算法。  
(2)利用图数据库或图处理框架，实现源码图谱的自动化构建。  
(3)优化源码图谱，确保其准确性和完整性，同时保留源码中的语义信息。  

4. 安全相关代码流提取  
(1)结合漏洞知识图谱，定义安全相关代码流的特征和模式。  
(2)在源码图谱中，利用图遍历和图匹配算法，识别与安全漏洞相关的代码流。  
(3)对提取出的安全相关代码流进行验证和标注，确保其准确性和有效性。

5. 提取效果验证  
(1)将提取的安全相关代码流作为输入，使用提示工程方法进行漏洞识别。  
(2)利用测试数据对训练后的模型进行验证和评估，确保其性能和准确性。  
(3)根据验证结果，对模型进行调优和改进，提高其预测准确性和鲁棒性。

6. 系统集成与测试  
(1)将源码依赖解析、源码图谱构建、安全相关代码流提取等模块集成到一个统一的系统中。  
(2)对系统进行测试和优化，确保其稳定性和效率。

7. 实验评估  
(1)对实验结果进行分析和评估，生成实现安全相关代码流的提取系统。  
(2)持续改进和优化系统功能和性能。

通过上述研究路线，本项目将实现自动化的源码依赖解析、源码图谱构建和安全相关代码流提取，为大语言模型提供精准输入，提高漏洞检测模型的可靠性和准确性，实现对代码漏洞的精准定位和准确查杀。

